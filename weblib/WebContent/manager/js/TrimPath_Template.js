/**
 * TrimPath Template. Release 1.1.2.
 * Copyright (C) 2004 - 2007 TrimPath.
 * 
 * TrimPath Template is licensed under the GNU General Public License
 * and the Apache License, Version 2.0, as follows:
 *
 * This program is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed WITHOUT ANY WARRANTY; without even the 
 * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
 * See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(typeof (TrimPath)=="undefined"){TrimPath={};}(function(){if(TrimPath.evalEx==null){TrimPath.evalEx=function(src){return eval(src);};}var _78;if(Array.prototype.pop==null){Array.prototype.pop=function(){if(this.length===0){return _78;}return this[--this.length];};}if(Array.prototype.push==null){Array.prototype.push=function(){for(var i=0;i<arguments.length;++i){this[this.length]=arguments[i];}return this.length;};}TrimPath.parseTemplate=function(_7a,_7b,_7c){if(_7c==null){_7c=TrimPath.parseTemplate_etc;}var _7d=_a7(_7a,_7b,_7c);var _7e=TrimPath.evalEx(_7d,_7b,1);if(_7e!=null){return new _7c.Template(_7b,_7a,_7d,_7e,_7c);}return null;};var _7f=function(e){return (e.toString())+";\n "+(e.message)+";\n "+(e.name)+";\n "+(e.stack||"no stack trace")+";\n "+(e.description||"no further description")+";\n "+(e.fileName||"no file name")+";\n "+(e.lineNumber||"no line number");};try{String.prototype.process=function(_81,_82){var _83=TrimPath.parseTemplate(this,null);if(_83!=null){return _83.process(_81,_82);}return this;};}catch(e){}TrimPath.parseTemplate_etc={};TrimPath.parseTemplate_etc.statementTag="forelse|for|if|elseif|else|var|macro";TrimPath.parseTemplate_etc.statementDef=function(_84){var _85="__S__"+_84;return {"if":{delta:1,prefix:"if (",suffix:") {",paramMin:1},"else":{delta:0,prefix:"} else {"},"elseif":{delta:0,prefix:"} else if (",suffix:") {",paramDefault:"true"},"/if":{delta:-1,prefix:"}"},"for":{delta:1,paramMin:3,prefixFunc:function(_86,_87,_88,etc){if(_86[2]!="in"){throw new etc.ParseError(_88,_87.line,"bad for loop statement: "+_86.join(" "));}var _8a=_86[1];var _8b="__LIST__"+_84+"__"+_8a;return ["var ",_8b," = ",_86[3],";","var "+_85+";","if (typeof("+_85+") == 'undefined' || !"+_85+".length) "+_85+" = new Array();",""+_85+"["+_85+".length] = 0;","if ((",_8b,") != null) { ","var ",_8a,"_ct = 0;","for (var ",_8a,"_index in ",_8b,") { ",_8a,"_ct++;","if (typeof(",_8b,"[",_8a,"_index]) == 'function') {continue;}",""+_85+"["+_85+".length - 1]++;","var ",_8a," = ",_8b,"[",_8a,"_index];"].join("");}},"forelse":{delta:0,prefix:"} } if ("+_85+"["+_85+".length - 1] == 0) { if (",suffix:") {",paramDefault:"true"},"/for":{delta:-1,prefix:"} }; delete "+_85+"["+_85+".length - 1];"},"var":{delta:0,prefix:"var ",suffix:";"},"macro":{delta:1,prefixFunc:function(_8c,_8d,_8e,etc){var _90=_8c[1].split("(")[0];return ["var ",_90," = function",_8c.slice(1).join(" ").substring(_90.length),"{ var _OUT_arr = []; var _OUT = { write: function(m) { if (m) _OUT_arr.push(m); } }; "].join("");}},"/macro":{delta:-1,prefix:" return _OUT_arr.join(''); };"}};};TrimPath.parseTemplate_etc.modifierDef={"eat":function(v){return "";},"escape":function(s){return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");},"capitalize":function(s){return String(s).toUpperCase();},"default":function(s,d){return s!=null?s:d;},"html":function(s){return String(s).replace(/&/g,"&#38;").replace(/"/g,"&#34;");}};TrimPath.parseTemplate_etc.modifierDef.h=TrimPath.parseTemplate_etc.modifierDef.escape;TrimPath.parseTemplate_etc.Template=function(_97,_98,_99,_9a,etc){this.process=function(_9c,_9d){if(_9c==null){_9c={};}if(_9c._MODIFIERS==null){_9c._MODIFIERS={};}if(_9c.defined==null){_9c.defined=function(str){return (_9c[str]!=undefined);};}for(var k in etc.modifierDef){if(_9c._MODIFIERS[k]==null){_9c._MODIFIERS[k]=etc.modifierDef[k];}}if(_9d==null){_9d={};}var _a0=[];var _a1={write:function(m){_a0.push(m);}};try{_9a(_a1,_9c,_9d);}catch(e){if(_9d.throwExceptions==true){throw e;}var _a3=new String(_a0.join("")+"[ERROR: template: <pre>"+_7f(e)+"</pre>]");_a3["exception"]=e;return _a3;}return _a0.join("");};this.name=_97;this.source=_98;this.sourceFunc=_99;this.toString=function(){return "TrimPath.Template ["+_97+"]";};};TrimPath.parseTemplate_etc.ParseError=function(_a4,_a5,_a6){this.name=_a4;this.line=_a5;this.message=_a6;};TrimPath.parseTemplate_etc.ParseError.prototype.toString=function(){return ("TrimPath template ParseError in "+this.name+": line "+this.line+", "+this.message);};var _f5=function(){return Math.floor(Math.random()*(1000000));};var _a7=function(_a8,_a9,etc,_ab){var _ab=(new Date()).getTime()+"$"+_f5();_a8=_df(_a8);var _ac=["var __T__"+_ab+" = function(_OUT, _CONTEXT, _FLAGS) { with (_CONTEXT) {"];var _ad={stack:[],line:1};var _ae=-1;while(_ae+1<_a8.length){var _af=_ae;_af=_a8.indexOf("{",_af+1);while(_af>=0){var _b0=_a8.indexOf("}",_af+1);var _b1=_a8.substring(_af,_b0);var _b2=_b1.match(/^\{(cdata|minify|eval)/);if(_b2){var _b3=_b2[1];var _b4=_af+_b3.length+1;var _b5=_a8.indexOf("}",_b4);if(_b5>=0){var _b6;if(_b5-_b4<=0){_b6="{/"+_b3+"}";}else{_b6=_a8.substring(_b4+1,_b5);}var _b7=_a8.indexOf(_b6,_b5+1);if(_b7>=0){_c4(_a8.substring(_ae+1,_af),_ac);var _b8=_a8.substring(_b5+1,_b7);if(_b3=="cdata"){_d6(_b8,_ac);}else{if(_b3=="minify"){_d6(_e1(_b8),_ac);}else{if(_b3=="eval"){if(_b8!=null&&_b8.length>0){_ac.push("_OUT.write( (function() { "+_b8+" })() );");}}}}_af=_ae=_b7+_b6.length-1;}}}else{if(_a8.charAt(_af-1)!="$"&&_a8.charAt(_af-1)!="\\"){var _b9=(_a8.charAt(_af+1)=="/"?2:1);if(_a8.substring(_af+_b9,_af+10+_b9).search(TrimPath.parseTemplate_etc.statementTag)==0){break;}}}_af=_a8.indexOf("{",_af+1);}if(_af<0){break;}var _b0=_a8.indexOf("}",_af+1);if(_b0<0){break;}_c4(_a8.substring(_ae+1,_af),_ac);_ba(_a8.substring(_af,_b0+1),_ad,_ac,_a9,etc,_ab);_ae=_b0;}_c4(_a8.substring(_ae+1),_ac);if(_ad.stack.length!=0){throw new etc.ParseError(_a9,_ad.line,"unclosed, unmatched statement(s): "+_ad.stack.join(","));}_ac.push("}}; __T__"+_ab);return _ac.join("");};var _ba=function(_bb,_bc,_bd,_be,etc,_c0){var _c1=_bb.slice(1,-1).split(" ");var _c2=(new etc.statementDef(_c0))[_c1[0]];if(_c2==null){_c4(_bb,_bd);return;}if(_c2.delta<0){if(_bc.stack.length<=0){throw new etc.ParseError(_be,_bc.line,"close tag does not match any previous statement: "+_bb);}_bc.stack.pop();}if(_c2.delta>0){_bc.stack.push(_bb);}if(_c2.paramMin!=null&&_c2.paramMin>=_c1.length){throw new etc.ParseError(_be,_bc.line,"statement needs more parameters: "+_bb);}if(_c2.prefixFunc!=null){_bd.push(_c2.prefixFunc(_c1,_bc,_be,etc));}else{_bd.push(_c2.prefix);}if(_c2.suffix!=null){if(_c1.length<=1){if(_c2.paramDefault!=null){_bd.push(_c2.paramDefault);}}else{for(var i=1;i<_c1.length;i++){if(i>1){_bd.push(" ");}_bd.push(_c1[i]);}}_bd.push(_c2.suffix);}};var _c4=function(_c5,_c6){if(_c5.length<=0){return;}var _c7=0;var _c8=_c5.length-1;while(_c7<_c5.length&&(_c5.charAt(_c7)=="\n")){_c7++;}while(_c8>=0&&(_c5.charAt(_c8)==" "||_c5.charAt(_c8)=="\t")){_c8--;}if(_c8<_c7){_c8=_c7;}if(_c7>0){_c6.push("if (_FLAGS.keepWhitespace == true) _OUT.write(\"");var s=_c5.substring(0,_c7).replace("\n","\\n");if(s.charAt(s.length-1)=="\n"){s=s.substring(0,s.length-1);}_c6.push(s);_c6.push("\");");}var _ca=_c5.substring(_c7,_c8+1).split("\n");for(var i=0;i<_ca.length;i++){_cc(_ca[i],_c6);if(i<_ca.length-1){_c6.push("_OUT.write(\"\\n\");\n");}}if(_c8+1<_c5.length){_c6.push("if (_FLAGS.keepWhitespace == true) _OUT.write(\"");var s=_c5.substring(_c8+1).replace("\n","\\n");if(s.charAt(s.length-1)=="\n"){s=s.substring(0,s.length-1);}_c6.push(s);_c6.push("\");");}};var _cc=function(_cd,_ce){var _cf="}";var _d0=-1;while(_d0+_cf.length<_cd.length){var _d1="${",endMark="}";var _d2=_cd.indexOf(_d1,_d0+_cf.length);if(_d2<0){break;}if(_cd.charAt(_d2+2)=="%"){_d1="${%";endMark="%}";}var _d3=_cd.indexOf(endMark,_d2+_d1.length);if(_d3<0){break;}_d6(_cd.substring(_d0+_cf.length,_d2),_ce);var _d4=_cd.substring(_d2+_d1.length,_d3).replace(/\|\|/g,"#@@#").split("|");for(var k in _d4){if(_d4[k].replace){_d4[k]=_d4[k].replace(/#@@#/g,"||");}}_ce.push("_OUT.write(");_d9(_d4,_d4.length-1,_ce);_ce.push(");");_d0=_d3;_cf=endMark;}_d6(_cd.substring(_d0+_cf.length),_ce);};var _d6=function(_d7,_d8){if(_d7==null||_d7.length<=0){return;}_d7=_d7.replace(/\\/g,"\\\\");_d7=_d7.replace(/\n/g,"\\n");_d7=_d7.replace(/"/g,"\\\"");_d8.push("_OUT.write(\"");_d8.push(_d7);_d8.push("\");");};var _d9=function(_da,_db,_dc){var _dd=_da[_db];if(_db<=0){_dc.push(_dd);return;}var _de=_dd.split(":");_dc.push("_MODIFIERS[\"");_dc.push(_de[0]);_dc.push("\"](");_d9(_da,_db-1,_dc);if(_de.length>1){_dc.push(",");_dc.push(_de[1]);}_dc.push(")");};var _df=function(_e0){_e0=_e0.replace(/\t/g,"    ");_e0=_e0.replace(/\r\n/g,"\n");_e0=_e0.replace(/\r/g,"\n");_e0=_e0.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1");return _e0;};var _e1=function(_e2){_e2=_e2.replace(/^\s+/g,"");_e2=_e2.replace(/\s+$/g,"");_e2=_e2.replace(/\s+/g," ");_e2=_e2.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1");return _e2;};TrimPath.parseDOMTemplate=function(_e3,_e4,_e5){if(_e4==null){_e4=document;}var _e6=_e4.getElementById(_e3);var _e7=_e6.value;if(_e7==null){_e7=_e6.innerHTML;}_e7=_e7.replace(/&lt;/g,"<").replace(/&gt;/g,">");return TrimPath.parseTemplate(_e7,_e3,_e5);};TrimPath.processDOMTemplate=function(_e8,_e9,_ea,_eb,_ec){return TrimPath.parseDOMTemplate(_e8,_eb,_ec).process(_e9,_ea);};})();